# 关键词工具 - Chrome扩展版 (Keyword Tool) v5.0

一个强大的Chrome浏览器扩展关键词处理工具，专为SEO优化和关键词分析设计。支持XLSX文件批量处理，采用创新的**关键词海洋并发优化**技术，实现极致性能。

## 🚀 功能特性

### 核心功能
- **📝 批量处理**: 支持拖拽上传XLSX文件，一键批量处理所有关键词
- **🌐 智能翻译**: 使用DeepSeek API自动将关键词翻译成中文
- **📊 Kdroi计算**: 自动计算关键词的投资回报率 (Volume × CPC ÷ Keyword Difficulty)
- **🔗 多平台链接**: 一键生成Google搜索、Google Trends和Ahrefs查询链接

### 🌊 关键词海洋优化 (v5.0重大更新)
- **⚡ 极致性能**: 突破文件边界限制，实现关键词级别并发处理
- **🚀 77%性能提升**: 相比传统处理模式，性能提升最高达77%
- **🎯 100%并发利用率**: 消除小文件浪费，每个批次都是满的80个关键词
- **📊 智能进度**: 关键词级别的实时进度显示，精确到每个关键词
- **🔄 双重索引**: 创新的文件索引+关键词索引映射系统，确保100%准确性

### 输出列说明
处理后的XLSX文件包含以下列：

| 列名 | 说明 |
|------|------|
| Keyword | 原始关键词 |
| Translation | 中文翻译 (DeepSeek API) |
| Intent | 用户意图 (保持原样) |
| Volume | 搜索量 |
| Keyword Difficulty | 关键词难度 |
| CPC (USD) | 每次点击费用 |
| **Kdroi** | **投资回报率 (数字格式，保留2位小数)** |
| SERP | Google搜索链接 |
| Google Trends | Google Trends趋势链接 |
| Ahrefs Keyword Difficulty Checker | Ahrefs难度查询链接 |

## 📦 扩展文件清单

- `manifest.json` - 扩展配置文件 (v5.0)
- `window.html` - 独立窗口界面 (700x900px面板)
- `window.js` - 核心业务逻辑 (关键词海洋优化算法)
- `background.js` - 后台脚本
- `xlsx.full.min.js` - Excel处理库
- `docs/` - 技术文档目录

## 🚀 安装方法

### 方法1：开发者模式安装（推荐）

1. **打开Chrome扩展管理页面**
   - 地址栏输入：`chrome://extensions/`
   - 或者：右上角三点菜单 → 更多工具 → 扩展程序

2. **启用开发者模式**
   - 右上角打开"开发者模式"开关

3. **加载扩展**
   - 点击"加载已解压的扩展程序"
   - 选择包含这些文件的文件夹

4. **完成安装**
   - 扩展会出现在扩展列表和工具栏
   - 工具栏会出现新的扩展图标

### 方法2：打包安装

1. **在扩展管理页面**
   - 点击"打包扩展程序"
   - 选择扩展文件夹，生成.crx文件

2. **拖拽安装**
   - 将.crx文件拖拽到扩展页面

## 🔧 使用方法

### 1. 启动扩展
- 点击工具栏的扩展图标
- 在弹出窗口中点击"打开独立窗口"

### 2. 配置API
- 在独立窗口界面输入你的DeepSeek API地址和密钥
- 点击"保存配置"

### 3. 处理文件
- 拖拽XLSX文件到上传区域或点击选择文件
- 观察关键词级别的实时进度显示 (如: 127/300)
- 处理完成后进度条变绿，显示"处理完毕"
- 下载处理后的文件

## 📁 输入文件格式

XLSX文件必须包含以下列：
- **Keyword**: 关键词
- **Intent**: 用户意图  
- **Volume**: 搜索量
- **Keyword Difficulty**: 关键词难度
- **CPC (USD)**: 每次点击费用

## 🔧 技术实现

### 技术栈
- **扩展平台**: Chrome Extension Manifest V3
- **前端**: HTML5 + CSS3 + 原生JavaScript (ES6+)
- **文件处理**: SheetJS (XLSX库)
- **API集成**: DeepSeek Chat Completions API
- **存储**: Chrome Storage API

### 核心特性
- ✅ **关键词海洋优化**: 突破文件边界，关键词级别并发处理
- ✅ **极致性能**: 25并发请求，77%性能提升
- ✅ **智能进度**: 关键词级别的实时进度显示
- ✅ **无跨域限制**: 可直接调用任何AI API
- ✅ **本地存储**: API密钥安全存储在Chrome本地
- ✅ **多文件支持**: 批量处理多个XLSX文件
- ✅ **错误恢复**: 完善的重试机制和错误处理
- ✅ **数字格式**: Kdroi列使用真正的Excel数字格式
- ✅ **完全去中心化**: 无需服务器，本地处理

## 🛡️ 安全特性

- **本地处理**: 所有数据处理都在本地完成，不会上传到服务器
- **API安全**: API密钥保存在Chrome本地存储，无泄露风险
- **文件安全**: 文件仅在本地处理，无网络传输
- **用户自付**: 每个人用自己的API密钥，费用自理

## ✅ 扩展优势

- **无跨域限制**: 可以直接调用任何AI API
- **本地存储**: API密钥保存在本地，安全
- **用户自付**: 每个人用自己的API密钥
- **完全去中心化**: 不需要服务器
- **即开即用**: 安装后即可使用，无需配置环境

## ⚠️ 注意事项

1. **浏览器支持**: 仅支持Chrome/Edge浏览器 (Manifest V3)
2. **API配置**: 确保DeepSeek API密钥正确配置
3. **文件格式**: 仅支持XLSX格式文件
4. **网络要求**: 需要网络连接以调用翻译API
5. **性能优化**: v5.0采用关键词海洋优化，性能提升77%
6. **界面模式**: 推荐使用独立窗口模式获得最佳体验
7. **数字格式**: Kdroi列已优化为真正的数字格式，支持Excel计算

## 📈 性能对比 (v5.0优化)

| 处理模式 | 耗时 | 性能提升 |
|---------|------|---------|
| 5并发 | 875.6秒 | 基准 |
| 15并发 | 343.8秒 | 60.7% |
| 25并发 | 293.4秒 | 66.5% |
| **关键词海洋25并发** | **199.9秒** | **77.2%** |

## 📊 示例

### 输入数据
| Keyword | Intent | Volume | Keyword Difficulty | CPC (USD) |
|---------|--------|--------|-------------------|-----------|
| best laptop | commercial | 10000 | 45 | 1.2 |

### 输出结果
| Keyword | Translation | Kdroi | SERP | Ahrefs Keyword Difficulty Checker |
|---------|-------------|-------|------|-----------------------------------|
| best laptop | 最佳笔记本 | 266.67 | [Google搜索](https://www.google.com/search?q=best%20laptop) | [Ahrefs查询](https://ahrefs.com/keyword-difficulty/?country=us&input=best%20laptop) |

## 🔧 故障排除

### 常见问题
1. **扩展无法加载**: 检查manifest.json文件格式是否正确
2. **API调用失败**: 检查API密钥是否正确，网络是否正常
3. **文件处理失败**: 确保XLSX文件格式正确，包含必需的列
4. **下载失败**: 检查浏览器下载设置，确保允许下载

### 调试方法
1. 打开扩展管理页面，点击"检查视图"查看控制台错误
2. 检查网络请求是否正常
3. 验证API密钥是否有效

## 📄 许可证

本项目仅供学习和个人使用。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个工具！

## 📚 技术文档

详细的技术实现和优化策略请参考：
- `docs/单词海洋并发优化.md` - 关键词海洋优化技术文档
- `docs/单词海洋优化实施总结.md` - 实施总结和测试结果
- `CLAUDE.md` - 项目开发文档和架构说明

## 🎯 v5.0更新亮点

- **关键词海洋架构**: 突破文件边界，实现关键词级别的无缝并发处理
- **双重索引系统**: 确保每个关键词都能准确追溯到原文件位置
- **智能批次切割**: 100%批次利用率，消除资源浪费
- **性能监控**: 完整的性能日志系统，实时监控处理状态
- **兼容性保证**: 保持原有功能的同时大幅提升性能